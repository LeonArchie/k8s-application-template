# Конфигурация шлюза
gate:
  # Конфигурация API
  api:
    # Список правил
    # Имя правила
    - name: k8s-01
      # Тело правила
      rule:
        # Регулярное выражение для эндпоинта к которому обращаются
        path: '^\/healthz$'
        # Метод на который разрешено обращаться если метод не совпадает - запрос отклоняется
        method: GET
        # Выполнять ли запрос к ОТТ для подтверждения операции
        ott: false
        # Выполнять ли проверку наличия RQID запросах
        rqid: false
        # Обязательный заголовок в запросе - пустой список заголовки не проверяются
        headers:
        # Тело запроса - пустое поле - тело не ожидается, если тело будет передано - запрос отклоняется
        body: 
    - name: k8s-02
      rule:
        path: '^\/readyz$'
        method: GET
        ott: false
        rqid: false
        headers:
        body:
    - name: app-01
      rule:
        path: '^\/v1\/auth\/login$'
        method: POST
        ott: false
        rqid: true
        # Обязательные заголовки 
        # Если заголовок отсутствует запрос отклоняется
        headers:
          - name: module-id
            value: EOS-CONF
          - name: module-id
            value: EOS-BBEL
        # тело запроса 
        # список полей который передаются и регулярное выражение для их валидации
        # если поле из запроса отсутствует в схеме то запрос отклоняется
        # если поле не соответствет регулярному выражению - запрос отклоняется
        # если переданы не все поля - запрос отклоняется
        body:
          - login: '^[a-zA-Z0-9_.@-]+$'
          - password: '^.{6,100}$'
          - type: '^(internal|LDAP)$'